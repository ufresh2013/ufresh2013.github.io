
<!DOCTYPE html>
<html lang="">


  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#202020">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    
        <meta name="keywords" content="">
        

          
              <meta name="description" content="节流与去抖 —— 图片加载优化">
              

                <link rel="icon" type="image/x-icon" href="data:image/png;base64,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">
                <title>
                  节流与去抖 —— 图片加载优化 [ 日常笔记 ]
                </title>
                
                  <!-- stylesheets list from config.yml -->
                  
                    <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
                    
                    <link rel="stylesheet" href="/css/microb.css">
                    
                      
  </head>

<body>
  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
        <div class="tab">
            <a href="/"><img src="/left.png" /></a>
            <span><a href="/">日常笔记</a></span>
            <!-- <span><a class="tab-search" href="/search/">搜索</a></span> -->
            
              <span><a class="tab-title" id="#Basic" href="/#Basic">Basic</a></span>
            
              <span><a class="tab-title" id="#Browser" href="/#Browser">Browser</a></span>
            
              <span><a class="tab-title" id="#Bug" href="/#Bug">Bug</a></span>
            
              <span><a class="tab-title" id="#CSS" href="/#CSS">CSS</a></span>
            
              <span><a class="tab-title" id="#Debug" href="/#Debug">Debug</a></span>
            
              <span><a class="tab-title" id="#HTML" href="/#HTML">HTML</a></span>
            
              <span><a class="tab-title" id="#HTTP" href="/#HTTP">HTTP</a></span>
            
              <span><a class="tab-title" id="#JS" href="/#JS">JS</a></span>
            
              <span><a class="tab-title" id="#LeetCode" href="/#LeetCode">LeetCode</a></span>
            
              <span><a class="tab-title" id="#NodeJS" href="/#NodeJS">NodeJS</a></span>
            
              <span><a class="tab-title" id="#React" href="/#React">React</a></span>
            
              <span><a class="tab-title" id="#Vue" href="/#Vue">Vue</a></span>
            
              <span><a class="tab-title" id="#其他" href="/#其他">其他</a></span>
            
          </div>
      
  <div id="toc" class="toc-article">
    <!--<strong class="toc-title">目录</strong>-->
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-问题"><span class="toc-text">1. 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-压缩图片体积"><span class="toc-text">1. 压缩图片体积</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-图片格式"><span class="toc-text">1.1 图片格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-图片裁剪"><span class="toc-text">1.2 图片裁剪</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-占位显示"><span class="toc-text">2. 占位显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-懒加载"><span class="toc-text">3. 懒加载</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-原理"><span class="toc-text">3.1 原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-节流函数"><span class="toc-text">3.2 节流函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-去抖函数"><span class="toc-text">3.3 去抖函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-骨架屏"><span class="toc-text">4. 骨架屏</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-渐进式图片加载"><span class="toc-text">5. 渐进式图片加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考资料"><span class="toc-text">参考资料</span></a></li></ol>
  </div>


<div class="section">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        节流与去抖 —— 图片加载优化
      </h1>
      
      <time class="time" datetime="2019-03-26T01:49:10.000Z">
        2019-03-26
      </time>
      
      <hr>
    </header>
    <div class="post-content">
      <h3 id="1-问题"><a href="#1-问题" class="headerlink" title="1. 问题"></a>1. 问题</h3><p>elitemba主站 以图片展示为主，启动页面时加载过多图片，图片体积过大，导致等待时间过长。这些图片请求几乎是并发的。在Chrome浏览器，同一域名，最多支持6个请求的并发，其他的请求将会推入到队列中等待，直到6个请求中的一个完成后，队列中的新请求才会发出。</p>
<p>下面列出一些图片加载优化方法。</p>
<p><br></p>
<h3 id="1-压缩图片体积"><a href="#1-压缩图片体积" class="headerlink" title="1. 压缩图片体积"></a>1. 压缩图片体积</h3><h4 id="1-1-图片格式"><a href="#1-1-图片格式" class="headerlink" title="1.1 图片格式"></a>1.1 图片格式</h4><p>Web图片格式有JPEG/JPG、PNG、WebP、Base64、SVG等。</p>
<p><em>JPEG/JPG</em><br><strong>有损压缩、体积小、不支持透明。</strong>当我们把图片体积压缩至原有体积的 50% 以下时，JPG 仍然可以保持住 60% 的品质。此外，JPG 格式以 24 位存储单个图，可以呈现多达 1600 万种颜色。JPG 适用于呈现色彩丰富的图片，在我们日常开发中，JPG 图片经常作为大的背景图、轮播图或 Banner 图出现。</p>
<p>但它处理矢量图形和logo等线条感较强、颜色对比强烈的图像时，人为压缩导致的图片模糊会相当明显。</p>
<p><em>PNG-8/PNG-24</em><br><strong>无损压缩、质量高、体积大、支持透明</strong> PNG是一种无损压缩的高保真的图片格式，8位PNG支持256中颜色，24位可呈现1600万中颜色。考虑到 PNG 在处理线条和颜色对比度方面的优势，我们主要用它来呈现小的 Logo、颜色简单且对比强烈的图片或背景。</p>
<p><em>SVG</em><br><strong>文本文件、体积小、不失真、兼容性好</strong>SVG是一种基于XML语法的图像格式，它对图像的处理不是基于像素点，而是基于对图像的形状描述。它的优势是图片可无线放大而不失真。因为SVG是文本文件，我们可以像写代码一样定义SVG，把它写在HTML里、成为DOM的一部分。</p>
<p><em>Base64</em><br>Base64不是一种图片格式，而是一种编码方式，作为小图标解决方案而存在。通过对图片进行baser64编码，我们可以直接将编码结果写入HTML或者CSS，从而减少HTTP请求的次数。</p>
<p><em>WebP</em><br>它于 2010 年被提出， 是Google专为Web开发的一种旨在加快图片加载速度的图片格式，它支持有损压缩和无损压缩。与png相比，WebP无损图像的大小可以缩小26%，比同类jpeg小25-36%。</p>
<p><br></p>
<h4 id="1-2-图片裁剪"><a href="#1-2-图片裁剪" class="headerlink" title="1.2 图片裁剪"></a>1.2 图片裁剪</h4><ul>
<li>阿里云oss图片服务 / 七牛图片服务，提供了图片格式转换、按尺寸裁剪等图片处理功能。配合<code>lib-flexible</code>，就可以对不同设备加载不同尺寸的图片。</li>
</ul>
<p><br></p>
<h3 id="2-占位显示"><a href="#2-占位显示" class="headerlink" title="2. 占位显示"></a>2. 占位显示</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">img</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">img</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">60%</span>;  <span class="comment">/* 图片比例 */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ccc</span> no-repeat center center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;img src="1.png"&gt;</span><br></pre></td></tr></table></figure>
<p>pc上，一般我们会为<code>&lt;img&gt;</code>设置width和height属性来解决图片占位问题。但在移动端，用占位图或min-height来占位，如果与需要加载的图片尺寸差别很大，会出现页面的内容跳动，这也不是我们想要的。</p>
<p><br><br><br></p>
<h3 id="3-懒加载"><a href="#3-懒加载" class="headerlink" title="3. 懒加载"></a>3. 懒加载</h3><p>滚动到可视区域后再去加载图片<br><br></p>
<h4 id="3-1-原理"><a href="#3-1-原理" class="headerlink" title="3.1 原理"></a>3.1 原理</h4><p>将页面中<code>&lt;img&gt;</code>的<code>src</code>指向一张默认图，然后定义<code>data-src</code>指向真实的图片。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注意: 图片要指定宽高 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"default.jpg"</span> <span class="attr">data-src</span>=<span class="string">"http://www.elitemba.cn/static/images/1.png"</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>当载入页面时，先把可视区域内的<code>&lt;img&gt;</code>标签的<code>data-src</code>属性值赋给<code>src</code>。然后监听滚动事件，同理修改可视区域的图片的src值。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.getElementsByTagName(<span class="string">'img'</span>);</span><br><span class="line"><span class="keyword">var</span> num = img.length;</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">0</span>;  <span class="comment">// 存储图片加载到的位置，避免每次都从第一张图片开始遍历</span></span><br><span class="line"></span><br><span class="line">lazyload(); <span class="comment">// 页面载入完毕加载可视区域内的图片</span></span><br><span class="line"><span class="built_in">window</span>.onscroll = lazyload;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lazyload</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> seeHeight = <span class="built_in">document</span>.documentElement.clientHeight; <span class="comment">// 可见区域高度</span></span><br><span class="line">  <span class="keyword">var</span> scrollTop = <span class="built_in">document</span>.documentElement.scrollTop || <span class="built_in">document</span>.body.scrollTop; <span class="comment">// 滚动条距离顶部高度</span></span><br><span class="line">  <span class="keyword">for</span> ( <span class="keyword">var</span> i = n ; i &lt; num; i++ )&#123;</span><br><span class="line">    <span class="keyword">if</span> (img[i].offsetTop &lt; seeHeight + scrollTop)&#123;</span><br><span class="line">      <span class="keyword">if</span> (img[i].getAttribute(<span class="string">"src"</span>) == <span class="string">"default.jpg"</span>)&#123;</span><br><span class="line">        img[i].src = img[i].getAttribute(<span class="string">"data-src"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      n = i + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="3-2-节流函数"><a href="#3-2-节流函数" class="headerlink" title="3.2 节流函数"></a>3.2 节流函数</h4><p>当函数绑定在<code>scroll</code>事件上，页面滚动时，函数会被高频触发，这非常影响浏览器的性能。这时需要限制触发频率。<br><strong>节流函数: 只允许一个函数在n秒内执行一次</strong>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// fun 要执行的函数</span></span><br><span class="line"><span class="comment">// time 在time时间内必须执行一次</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fun, time</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> startTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> context = <span class="keyword">this</span>,</span><br><span class="line">        args = <span class="built_in">arguments</span>,</span><br><span class="line">        curTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果达到了规定的触发时间间隔，触发handler</span></span><br><span class="line">    <span class="keyword">if</span> ( curTime - startTime &gt;= time )&#123;</span><br><span class="line">      fun.apply(context, args);</span><br><span class="line">      startTime = curTime;</span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"scroll"</span>, throttle(lazy, <span class="number">1000</span>))</span><br></pre></td></tr></table></figure>
<p><br></p>
<h4 id="3-3-去抖函数"><a href="#3-3-去抖函数" class="headerlink" title="3.3 去抖函数"></a>3.3 去抖函数</h4><p>让函数延迟执行。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> time = <span class="literal">null</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> context = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">let</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">    clearTimeout(time);</span><br><span class="line">    timer = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      fn.apply(context, args)</span><br><span class="line">    &#125;, delay)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 让函数延迟500s执行</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"scroll"</span>, debounce(lazyload, <span class="number">500</span>))</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="4-骨架屏"><a href="#4-骨架屏" class="headerlink" title="4. 骨架屏"></a>4. 骨架屏</h3><p>骨架屏可以理解为<em>当数据还未加载进来前，页面的一个空白版本</em>。页面渲染完成之前，用户会看到当前页面的大致骨架。</p>
<p>下面的示例图，第一个是骨架屏，第二个是菊花图，第三个无优化。<br><br><br><img src="/2019/03/26/网页图片加载优化/2.gif" style="max-width: 800px"><br><br></p>
<p>生成骨架屏的方式: </p>
<ul>
<li>手写HTML，CSS定制骨架屏，但是维护成本高</li>
<li>使用图片作为骨架屏： 小米商城的移动端页面</li>
<li>自动生成并自动插入静态骨架屏 page-skeleton-webpack-plugin</li>
</ul>
<p><br></p>
<h3 id="5-渐进式图片加载"><a href="#5-渐进式图片加载" class="headerlink" title="5. 渐进式图片加载"></a>5. 渐进式图片加载</h3><p>知乎会用低分辨的模糊图片来做预览图，代替懒加载图片时用的logo占位图，预览图大小在2kb-3kb之间。<br><img src="/2019/03/26/网页图片加载优化/1.gif"></p>
<p><br></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="https://zhuanlan.zhihu.com/p/33370207" target="_blank" rel="noopener">网页图片加载优化方案</a></li>
<li><a href="https://github.com/Jocs/jocs.github.io/issues/22" target="_blank" rel="noopener">一种自动化生成骨架屏的方案</a></li>
<li><a href="https://juejin.im/post/5b79a2786fb9a01a18267362" target="_blank" rel="noopener">Vue项目骨架屏注入实践</a></li>
<li><a href="https://github.com/ccforward/cc/issues/64" target="_blank" rel="noopener">适用于vue.js和原生js的渐进式图片加载</a></li>
<li><a href="https://juejin.im/post/583b10640ce463006ba2a71a" target="_blank" rel="noopener">实现图片懒加载</a></li>
<li><a href="https://github.com/ElemeFE/page-skeleton-webpack-plugin" target="_blank" rel="noopener">page-skeleton-webpack-plugin</a></li>
<li><a href="https://www.jianshu.com/p/a5fd143c6184" target="_blank" rel="noopener">CSS实现图片未加载完成时占位显示</a></li>
<li><a href="https://lq1228.github.io/front/article/2016/11/24/layout-image.html" target="_blank" rel="noopener">CSS实现 图片加载前的占位高度预设</a></li>
</ul>

    </div>
  </article>
    
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>〈 </span>
          <a href="/2019/03/14/数据结构与算法/" rel="next" title="数据结构与算法">
          数据结构与算法
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
        
          <a href="/2019/03/28/文件上传/" rel="prev" title="表单组件，formData，file对象">
            表单组件，formData，file对象
          </a>
          <span>〉</span>
        
      </div>
    </div>
  
</div>


<script>
var link = document.getElementsByClassName('toc-link');
var hash = decodeURIComponent(location.hash);
if (hash){
} else {
  link[0].classList.add('toc-link-active');
}

var h3 = document.getElementsByTagName('h3');
var h4 = document.getElementsByTagName('h4');
var h5 = document.getElementsByTagName('h5');
var link_arr = [];
function addToArr(arr){
  for(var i = 0; i < arr.length; i++){
    link_arr.push(arr[i].offsetTop);
  }
}
addToArr(h3);
addToArr(h4);
addToArr(h5);


var compare = function (x, y) {
    if (x < y) {
        return -1;
    } else if (x > y) {
        return 1;
    } else {
        return 0;
    }
}

link_arr.sort(compare);


window.onscroll = function(){
  var height = document.documentElement.scrollTop;
  for (var i = 0; i < link_arr.length; i++){
    if (link_arr[i] > height){
      for(var j = 0; j < link.length; j++){
        link[j].classList.remove('toc-link-active');
      }
      document.getElementsByClassName('toc-link')[i].classList.add('toc-link-active');
      break;
    } 
  }
}

</script>
    </div>
  </div>
  




    <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js"></script>
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // listen to any DOM change and automatically perform spacing via MutationObserver()
        pangu.autoSpacingPage();
      });

      window.addEventListener("load", event => {
        // 判断浏览器是否支持
        if ("serviceWorker" in navigator) {
          window.navigator.serviceWorker
            .register("/sw.js", {
              scope: "/"
            })
        }
      });
    </script>
</body>
</html>

