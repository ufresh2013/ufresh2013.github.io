
<!DOCTYPE html>
<html lang="">


  <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" content="#202020">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    
        <meta name="keywords" content="">
        

          
              <meta name="description" content="快速开始Edx-H版开发">
              

                <link rel="icon" type="image/x-icon" href="data:image/png;base64,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">
                <title>
                  快速开始Edx-H版开发 [ 日常笔记 ]
                </title>
                
                  <!-- stylesheets list from config.yml -->
                  
                    <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
                    
                    <link rel="stylesheet" href="/css/microb.css">
                    
                      
  </head>

<body>
  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
        <div class="tab">
            <a href="/"><img src="/left.png" /></a>
            <span><a href="/">日常笔记</a></span>
            <!-- <span><a class="tab-search" href="/search/">搜索</a></span> -->
            
              <span><a class="tab-title" id="#Basic" href="/#Basic">Basic</a></span>
            
              <span><a class="tab-title" id="#Browser" href="/#Browser">Browser</a></span>
            
              <span><a class="tab-title" id="#Bug" href="/#Bug">Bug</a></span>
            
              <span><a class="tab-title" id="#CSS" href="/#CSS">CSS</a></span>
            
              <span><a class="tab-title" id="#Debug" href="/#Debug">Debug</a></span>
            
              <span><a class="tab-title" id="#HTML" href="/#HTML">HTML</a></span>
            
              <span><a class="tab-title" id="#HTTP" href="/#HTTP">HTTP</a></span>
            
              <span><a class="tab-title" id="#JS" href="/#JS">JS</a></span>
            
              <span><a class="tab-title" id="#LeetCode" href="/#LeetCode">LeetCode</a></span>
            
              <span><a class="tab-title" id="#NodeJS" href="/#NodeJS">NodeJS</a></span>
            
              <span><a class="tab-title" id="#React" href="/#React">React</a></span>
            
              <span><a class="tab-title" id="#Vue" href="/#Vue">Vue</a></span>
            
              <span><a class="tab-title" id="#其他" href="/#其他">其他</a></span>
            
          </div>
      
  <div id="toc" class="toc-article">
    <!--<strong class="toc-title">目录</strong>-->
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-前提"><span class="toc-text">1. 前提</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-安装启动"><span class="toc-text">2. 安装启动</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-安装项目"><span class="toc-text">2.1 安装项目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-启动项目"><span class="toc-text">2.1 启动项目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-常用命令"><span class="toc-text">2.2 常用命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-代码修改"><span class="toc-text">3. 代码修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-配置主题"><span class="toc-text">4. 配置主题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-主题修改"><span class="toc-text">5. 主题修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-sass编译"><span class="toc-text">5.1 sass编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-一些规范"><span class="toc-text">5.2 一些规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-3-替换templates"><span class="toc-text">5.3 替换templates</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-edx前端技术选型"><span class="toc-text">6. edx前端技术选型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考文档"><span class="toc-text">参考文档</span></a></li></ol>
  </div>


<div class="section">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        快速开始Edx-H版开发
      </h1>
      
      <time class="time" datetime="2019-05-09T05:52:44.000Z">
        2019-05-09
      </time>
      
      <hr>
    </header>
    <div class="post-content">
      <h3 id="1-前提"><a href="#1-前提" class="headerlink" title="1. 前提"></a>1. 前提</h3><p>要快速入门edx，首先你可以体验一下英荔商学院，</p>
<ul>
<li>阿里云生产服  <a href="https://www.elitemba.cn/" target="_blank" rel="noopener">https://www.elitemba.cn/</a></li>
<li>腾讯云测试服 lms <a href="http://www.eliteu.xyz/" target="_blank" rel="noopener">http://www.eliteu.xyz/</a></li>
<li>腾讯云测试服 cms <a href="http://studio.eliteu.xyz/" target="_blank" rel="noopener">http://studio.eliteu.xyz/</a></li>
</ul>
<p>同时还可以</p>
<ul>
<li>通过edx官方文档进一步了解  <a href="http://docs.edx.org/" target="_blank" rel="noopener">http://docs.edx.org/</a></li>
<li>其他用edx搭建的网站：<a href="http://www.xuetangx.com/" target="_blank" rel="noopener">http://www.xuetangx.com/</a> , <a href="https://www.edx.org" target="_blank" rel="noopener">https://www.edx.org</a></li>
</ul>
<p>了解edx H版前，你需要掌握一些基本知识</p>
<ul>
<li>Docker <a href="https://docs.docker.com/" target="_blank" rel="noopener">https://docs.docker.com/</a> </li>
<li>git    <a href="https://git-scm.com/book/zh/v2" target="_blank" rel="noopener">https://git-scm.com/book/zh/v2</a></li>
<li>React  <a href="https://react.docschina.org/" target="_blank" rel="noopener">https://react.docschina.org/</a></li>
<li>Sass   <a href="https://www.sass.hk/" target="_blank" rel="noopener">https://www.sass.hk/</a></li>
</ul>
<p><br></p>
<h3 id="2-安装启动"><a href="#2-安装启动" class="headerlink" title="2. 安装启动"></a>2. 安装启动</h3><h4 id="2-1-安装项目"><a href="#2-1-安装项目" class="headerlink" title="2.1 安装项目"></a>2.1 安装项目</h4><p>这里假设你已经完成安装，如果没有，<a href="https://github.com/edx/devstack" target="_blank" rel="noopener">前往安装</a>。<br>拉取公司最新代码，修改配置文件。每个文件夹对应一个git仓库<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">└── devstack  </span><br><span class="line">└── ecommerce       # 单课购买        https://github.com/e-ducation/ecommerce</span><br><span class="line">└── edx-membership  # 会员购买        https://github.com/e-ducation/edx-membership</span><br><span class="line">└── edx-platform    </span><br><span class="line">    # lms学习平台, cms创建课程平台      https://github.com/e-ducation/edx-platform</span><br><span class="line">└── eliteu-payments # 微信支付宝支付   https://github.com/e-ducation/eliteu-payments</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="2-1-启动项目"><a href="#2-1-启动项目" class="headerlink" title="2.1 启动项目"></a>2.1 启动项目</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd devstack</span><br><span class="line">make dev.up   # 启动项目</span><br></pre></td></tr></table></figure>
<p>启动服务后，每个服务都可以在<code>localhost</code>的特定端口被访问(<code>docker ps</code>查看所有url)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Service           URL</span><br><span class="line">E-commerce        http://localhost:18130/dashboard/</span><br><span class="line">LMS               http://localhost:18000/</span><br><span class="line">Studio/CMS        http://localhost:18010/</span><br></pre></td></tr></table></figure></p>
<p>本地环境会自动创建一个超级用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Email: edx@example.com</span><br><span class="line">Username: edx</span><br><span class="line">Password: edx</span><br></pre></td></tr></table></figure></p>
<p>LMS还提供了不同身份的账号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Username    Email                   Password</span><br><span class="line">audit	      audit@example.com       edx</span><br><span class="line">honor	      honor@example.com       edx</span><br><span class="line">staff	      staff@example.com       edx</span><br><span class="line">verified	  verified@example.com    edx</span><br></pre></td></tr></table></figure></p>
<p>有了这些url和账号密码，你可以在本地把业务流程都走一遍：<br>创建课程，使用优惠券购买单课，会员购买，课程学习——习题，讨论，维基，教师面板等</p>
<p><br></p>
<h4 id="2-2-常用命令"><a href="#2-2-常用命令" class="headerlink" title="2.2 常用命令"></a>2.2 常用命令</h4><p>使用<code>make</code>命令可以查看所有make命令，下面列举一些常用操作。<a href="https://github.com/edx/devstack" target="_blank" rel="noopener">更多命令查看</a></p>
<ul>
<li><p><em>修改配置文件</em><br>通过<code>make &lt;service&gt;-shell</code>进入容器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 进入lms容器</span><br><span class="line">make lms-shell</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 进入lms-shell后，你可以修改各种配置文件</span><br><span class="line">/edx/app/edxapp/lms.env.json</span><br><span class="line">/edx/app/edxapp/lms.auth.json</span><br><span class="line">/edx/app/edxapp/cms.env.json</span><br><span class="line">/edx/app/edxapp/cms.auth.json</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>查看日志</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 查看运行中的容器的日志</span><br><span class="line">make logs</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 查看特定的容器的日志</span><br><span class="line">make lms-logs</span><br><span class="line">make discovery-logs</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>编译静态资源</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 编译lms静态资源</span><br><span class="line">make lms-static  </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 只编译normal-theme(英荔的主题包)</span><br><span class="line">make lms-shell</span><br><span class="line">paver update_assets --theme-dirs=/edx/app/edxapp/edx-platform/themes --themes=normal-theme</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 自动编译sass文件</span><br><span class="line">make lms-shell</span><br><span class="line">paver watch_assets --td /edx/app/edxapp/edx-platform/themes --t normal-theme</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 如果在执行paver命令时遇到了异常，加上--settings=devstack_docker查看报错信息</span><br><span class="line">paver update_assets --settings=devstack_docker</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>更新数据库</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">make lms-shell</span><br><span class="line">paver update_db</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 只更新lms的某个app</span><br><span class="line"><span class="meta">#</span> 更新/edx-platform/lms/djangoapps/badges, appname为badges</span><br><span class="line">make lms-shell</span><br><span class="line">source /edx/app/edxapp/edxapp_env</span><br><span class="line">cd /edx/app/edxapp/edx-platform</span><br><span class="line">./manage.py &lt;lms/cms&gt; makemigrations &lt;appname&gt; --settings=devstack_docker</span><br><span class="line">./manage.py &lt;lms/cms&gt; migrate &lt;appname&gt; --settings=devstack_docker</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>重启服务</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> service可取值: discovery, ecommerce, lms, studio</span><br><span class="line">docker-compose restart &lt;service&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 或者直接使用make命令</span><br><span class="line">make lms-restart</span><br></pre></td></tr></table></figure>
</li>
<li><p><em>停止所有服务</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make stop</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<h3 id="3-代码修改"><a href="#3-代码修改" class="headerlink" title="3. 代码修改"></a>3. 代码修改</h3><p>前端代码修改主要包括</p>
<ul>
<li><p>主题样式<br>根据设计稿，响应式布局，一个页面兼容pc，手机，需考虑中英文两种情况。兼容到IE11</p>
</li>
<li><p>浏览器兼容<br>js不生效，样式兼容</p>
</li>
<li><p>翻译修改<br>翻译未包，修改英文文案</p>
</li>
<li><p>新增页面<br>教授介绍页，membership会员介绍页，会员购买页(微信支付宝)，课程简介html编写等</p>
</li>
<li><p>修改功能<br>①登录账号可输入邮箱，变为可输入手机+邮箱；<br>②绑定手机<br>③生成证书图片；<br>④接入微信sdk实现转发课程详情页显示链接头像，等等</p>
</li>
<li><p>协助后端解决bug</p>
</li>
</ul>
<p><br><br><br></p>
<h3 id="4-配置主题"><a href="#4-配置主题" class="headerlink" title="4. 配置主题"></a>4. 配置主题</h3><p>先阅读<a href="https://edx.readthedocs.io/projects/edx-installing-configuring-and-running/en/latest/configuration/changing_appearance/theming/index.html" target="_blank" rel="noopener">官方文档</a>，了解主题包如何创建，修改，配置。</p>
<p><em>主题包可以放什么文件 ？</em><br>To override the files that constitute the default Open edX theme, you create replacements for one or more of those files, place them in the file paths that are constructed and named in parallel to the default file locations, configure your Open edX instance to use the files in your theme’s directories instead of the default locations, and then compile the theme.<br>(EdX first looks for files in your theme directories, and uses any file that matches the exact file path and file name of a default UI file.)<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/edx-platform/lms/static/images</span><br><span class="line">/edx-platform/lms/static/sass</span><br><span class="line">/edx-platform/lms/templates</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 想要覆盖上面的文件，需要在主题包里创建对应的文件</span><br><span class="line">/themes/normal-theme/lms/static</span><br><span class="line">/themes/normal-theme/lms/sass</span><br><span class="line">/themes/normal-theme/lms/templates</span><br></pre></td></tr></table></figure></p>
<p><br><br><em>添加主题包</em><br>在<code>/edx-platform/themes</code>新建一个文件夹<code>normal-theme</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">normal-theme</span><br><span class="line">    ├── README.rst</span><br><span class="line">    ├─── lms</span><br><span class="line">    |     ├── static</span><br><span class="line">    |     |      └── images</span><br><span class="line">    |     |      |     └── logo.png</span><br><span class="line">    |     |      |</span><br><span class="line">    |     |      └── sass</span><br><span class="line">    |     |            └── partials</span><br><span class="line">    |     |                   └── base</span><br><span class="line">    |     |                        └── _variables.scss</span><br><span class="line">    |     |</span><br><span class="line">    |     └── templates</span><br><span class="line">    |             └── footer.html</span><br><span class="line">    |             └── header.html</span><br></pre></td></tr></table></figure></p>
<p><br><br><em>修改配置文件</em><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> 进入文件目录</span><br><span class="line">make lms-shell</span><br><span class="line">cd /edx/app/edxapp</span><br><span class="line">LMS	         /edx/app/edxapp/lms.env.json</span><br><span class="line">Studio       /edx/app/edxapp/cms.env.json</span><br><span class="line">E-commerce   /edx/etc/ecommerce.yml</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 修改配置项</span><br><span class="line">"ENABLE_COMPREHENSIVE_THEMING": true,</span><br><span class="line">"COMPREHENSIVE_THEME_DIRS": [</span><br><span class="line">  "/edx/app/edxapp/edx-platform/themes"</span><br><span class="line">],</span><br><span class="line">"THEME_NAME": "normal-theme",</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 重启服务</span><br><span class="line">docker-compose restart lms</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 编译静态资源</span><br><span class="line">make lms-static</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> 进入`localhost:18000/admin`,进入Site themes, 添加site themes。保存后，访问0.0.0.0:18000即生效。</span><br><span class="line">Site:</span><br><span class="line">Domain name: 0.0.0.0:18000</span><br><span class="line">Display name: normal-theme</span><br><span class="line">Theme dir name: normal-theme</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h3 id="5-主题修改"><a href="#5-主题修改" class="headerlink" title="5. 主题修改"></a>5. 主题修改</h3><p>改edx主题是一件非常痛苦的事件。每改一个地方，需要执行一次编译命令，才能看到效果。快则1分钟，慢则20分钟。同时，edx的模板层层嵌套，同一个className会应用到多个页面，牵一发动全身。加上className又长又乱，css也是没啥章法，<code>border-box</code>与<code>content-box</code>混用，样式乱加<code>!important</code>，很多时候你不得不再强制加一个<code>!important</code>去覆盖它。加上本身没有使用任何基础库，因此衍生出很多兼容问题。</p>
<ul>
<li>值得高兴的是，大部分页面都已经完成了样式调整。</li>
<li>开发环境走了另一套编译，你无需执行edx的编译命令，就可以看到修改效果。</li>
<li>如果有新增的需求，你需要遵循一些设计规范。</li>
</ul>
<p><br></p>
<h4 id="5-1-sass编译"><a href="#5-1-sass编译" class="headerlink" title="5.1 sass编译"></a>5.1 sass编译</h4><p>先确保安装了<a href="https://www.sass.hk/install/" target="_blank" rel="noopener">Sass</a><br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> edx-platform编译</span><br><span class="line"><span class="meta">#</span> 注意，当编译不是主题包里面的sass文件时，依然要走edx的编译命令 make lms-static</span><br><span class="line">cd edx-platform/themes/normal-theme/lms/static/</span><br><span class="line">sass --watch sass:css --no-cache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> edx-membership编译</span><br><span class="line">cd edx-membership/membership/static/membership/</span><br><span class="line">sudo sass --watch sass:css --no-cache</span><br></pre></td></tr></table></figure></p>
<p>edx不同页面引用了不同的css文件，因此产生了很多入口文件，具体见<code>/edx-platform/lms/static/sass</code>，里面没有以<code>_</code>开头的文件都是一个入口文件。</p>
<p>当你需要新增一个入口文件，应当先将其对应的css文件<code>/edx-platform/lms/static/css</code>转换为scss文件，复制到<code>normal-theme/lsm/static/sass/default</code>。入口文件，应先引用该文件，代表着先引用了edx原有样式。然后你可以把你的修改放进<code>normal-theme/lsm/static/sass/modify</code>文件。</p>
<p>当edx升级版本时，你需要更新<code>/default</code>的内容。而你额外的修改将得到保留。当然如果发生了翻天覆地的变动，就另说。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">normal-theme/lsm/static/sass</span><br><span class="line">    ├─── bootstrap</span><br><span class="line">    |     ├── lms-main.scss  # 入口文件</span><br><span class="line">    ├─── default             # edx原有样式</span><br><span class="line">    |     ├── _lms-course.scss</span><br><span class="line">    |     ├── _lms-discussion-bootstrap.scss</span><br><span class="line">    |     ├── _lms-main-v1.scss</span><br><span class="line">    |     ├── _lms-main-v2.scss</span><br><span class="line">    |     ├── _lms-main.scss</span><br><span class="line">    ├─── discussion</span><br><span class="line">    |     ├── lms-discussion-bootstrap.scss  # 入口文件</span><br><span class="line">    ├─── modify</span><br><span class="line">    |     ├── lms</span><br><span class="line">    |     |      └── course            # 课程相关</span><br><span class="line">    |     |      └── footer            </span><br><span class="line">    |     |      └── page              </span><br><span class="line">    |     |      └── _extras.scss      # 集合了header,footer,iconfont,base,alert等共用规则，所有入口文件均可先引用这一文件</span><br><span class="line">    |     |      └── _variables.scss   # 定义sass变量</span><br><span class="line">    ├─── lms-course.scss     # 入口文件</span><br><span class="line">    ├─── lms-main-v1.scss    # 入口文件</span><br><span class="line">    ├─── lms-main-v2.scss    # 入口文件</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h4 id="5-2-一些规范"><a href="#5-2-一些规范" class="headerlink" title="5.2 一些规范"></a>5.2 一些规范</h4><ul>
<li><em>适配要求</em><br>pc响应式布局，兼容ipad，手机，兼容IE11<br>图片资源pc使用二倍图，手机使用三倍图<br>pc设计稿尺寸1400px*auto (内容1200px*auto), 手机设计稿尺寸375px*auto<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/* 兼容ipad */</span></span><br><span class="line">@<span class="keyword">media</span> screen and (max-width:<span class="number">768px</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 兼容手机，考虑了部分手机横屏的情况 */</span></span><br><span class="line">@<span class="keyword">media</span> screen and (max-width:<span class="number">767px</span>)&#123;&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<ul>
<li><em>变量</em><br>更多变量查看 <code>/edx-platform/themes/normal-theme/lms/static/sass/modify/lms/_variables.scss</code>，设计稿有时不会100%按这个标准，此时应优先使用这些变量。<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 主色调 */</span> </span><br><span class="line">$primary: #4788C7;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 字体颜色: 标题，正文，注释，placeholder */</span> </span><br><span class="line">$title: #2E313C;</span><br><span class="line">$font: #656D78;</span><br><span class="line">$note: #AAB2BD;</span><br><span class="line">$placeholder: #ccd1d9;</span><br><span class="line">$font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue", Helvetica,Tahoma，Arial, "PingFang SC", "Hiragino Sans GB", </span><br><span class="line">"<span class="selector-tag">Heiti</span> <span class="selector-tag">SC</span>", "<span class="selector-tag">Microsoft</span> <span class="selector-tag">YaHei</span>", "<span class="selector-tag">WenQuanYi</span> <span class="selector-tag">Micro</span> <span class="selector-tag">Hei</span>",<span class="selector-tag">SimHei</span>，<span class="selector-tag">sans-serif</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* border */</span></span><br><span class="line">$border:#b6dcfe;</span><br><span class="line">$border-gray: #f5f7fa;</span><br><span class="line">$border-radius: 3px;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 正文字体统一为14px */</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<ul>
<li><em>通用样式</em><br>查看<code>/edx-platform/themes/normal-theme/lms/static/sass/modify/lms/page/_base.scss</code>，这个文件定义了button, input, select, <code>&lt;a&gt;</code>的样式。开发时应统一使用这些变量。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@extend %btn-my-primary;</span><br><span class="line">@extend %btn-my-white;</span><br><span class="line">@extend %btn-my-disable;</span><br><span class="line"></span><br><span class="line">@extend %input-my;</span><br><span class="line">@extend %input-my-checkbox;</span><br><span class="line">@extend %input-my-radio;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<ul>
<li><p><em>避免修改外层div的class样式</em><br>edx所有页面均被下面两个<code>&lt;div&gt;</code>包裹，注意不要轻易修改、新增这两个className的样式，不然其他页面都会发生变动。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"window-wrap"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"content-wrapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>除了这两个className，页面里面也有很多很多很多共用的className。<br>修改sass的时候，应当在外面包一个专属这个页面的className，避免影响到其他页面</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/edx-platform/themes/normal-theme/lms/static/sass/modify/lms/page/_login.scss</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 只对login-register下的h2生效 */</span></span><br><span class="line"><span class="selector-class">.login-register</span>&#123;</span><br><span class="line">  h2&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><br></p>
<ul>
<li><em>替换icon</em><br>icon使用雪碧图替换，具体查看<code>/edx-platform/themes/normal-theme/lms/static/sass/modify/lms/page/_iconfont.scss</code></li>
</ul>
<p><br></p>
<h4 id="5-3-替换templates"><a href="#5-3-替换templates" class="headerlink" title="5.3 替换templates"></a>5.3 替换templates</h4><p>如果需要修改/templates，需把原来的模板文件复制一份，放到主题下，在其基础上修改。<br>当模板里需要添加图片需使用<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"$&#123;static.url("</span><span class="attr">images</span>/<span class="attr">logo.svg</span>")&#125; "&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>Note that the code snippet ${static.url(“images/logo.svg”)} directs Mako to leverage the comprehensive theming system, which will first check to see if your custom theme contains the file “logo.svg”, and if so, then this is the image file that will be sent to the browser. </p>
<p>All image files and other “static assets” are pre-processed using an open source utility named Paver that consolidates the files into a caching area located in <code>/edx/var/edxapp/staticfiles</code> whereupon each file is individually optimized.</p>
<p><br></p>
<h3 id="6-edx前端技术选型"><a href="#6-edx前端技术选型" class="headerlink" title="6. edx前端技术选型"></a>6. edx前端技术选型</h3><p>Edx前端囊括了展示给用户的所有东西，主要包括用Python渲染的views，用js写的页面交互，和css样式。</p>
<p><em>Edx相关技术</em></p>
<ul>
<li>Test: React components can be tested in isolation with unit tests using <code>Jest</code> and <code>Enzyme</code>.</li>
<li>ES6</li>
<li>Babel</li>
<li>ESLint</li>
<li>npm</li>
<li>GreenKeeper</li>
<li>webpack</li>
<li>AMD(异步模块定义）</li>
<li>Sass</li>
<li>JWT</li>
<li>Axios</li>
<li>React and Redux<br>当构建新UI的时候，应当使用React。但是现在绝大部分没有使用。上次edx年会说，2019年底会完成向react转移。</li>
</ul>
<p><br><br><em>一些新React App仓库</em><br>Account页  <a href="https://github.com/edx/frontend-app-account" target="_blank" rel="noopener">https://github.com/edx/frontend-app-account</a><br>Profile页  <a href="https://github.com/edx/frontend-app-profile" target="_blank" rel="noopener">https://github.com/edx/frontend-app-profile</a></p>
<ul>
<li>环境变量通过webpack.config中process.env配置</li>
<li>没有发现使用了UI库</li>
<li>使用redux,axios,mock</li>
<li>卡在了<code>Access to XMLHttpRequest at ’http://localhost:18000/api/user/v1/accounts/edx&#39; from origin ‘http://localhost:1997’ has been blocked by CORS policy: Request header field use-jwt-cookie is not allowed by Access-Control-Allow-Headers in preflight response.”</code><br>slack回复需更新master分支devstack。</li>
<li>一些已经多个react app用到的包<br>@edx/frontend-auth  统一处理登录<br>@edx/edx-bootstrap<br>@edx/frontend-component-footer</li>
</ul>
<p><br><br><em>publisher-frontend</em><br><a href="https://github.com/edx/publisher-frontend" target="_blank" rel="noopener">https://github.com/edx/publisher-frontend</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">路由                    对应组件              功能</span><br><span class="line">/courses/new           CreateCourse         新建课程，填写org, title, price,</span><br><span class="line">/courses/:id/rerun     CreateCourseRun</span><br><span class="line">/instructors/new       CreateStaffer        新建Staff,填写name,organization_id, bio, major_works</span><br><span class="line">/instructors/:uuid     EditStaffer</span><br><span class="line">/                      CourseDashboard      列表course name, course number, owner, modified</span><br><span class="line">/courses/:id           EditCourse           编辑课程 title, description, what will you learn, primary subject,course-image, about-video-link</span><br></pre></td></tr></table></figure>
<p><br></p>
<h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul>
<li><a href="http://docs.edx.org/" target="_blank" rel="noopener">edx官方文档</a></li>
<li><a href="https://edx.readthedocs.io/projects/edx-installing-configuring-and-running/en/latest/configuration/changing_appearance/theming/index.html" target="_blank" rel="noopener">edx主题包官方文档</a></li>
<li><a href="https://github.com/edx/devstack" target="_blank" rel="noopener">安装edx H版</a></li>
<li><a href="https://blog.lawrencemcdaniel.com/how-to-change-the-open-edx-logo/" target="_blank" rel="noopener">How To Change the Open edX Logo</a></li>
<li><a href="https://open-edx-proposals.readthedocs.io/en/latest/oep-0011-bp-FED-technology.html" target="_blank" rel="noopener">OEP-11: Front End Technology Standards</a></li>
</ul>

    </div>
  </article>
    
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>〈 </span>
          <a href="/2019/04/30/iframe/" rel="next" title="iframe的各种问题">
          iframe的各种问题
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
        
          <a href="/2019/05/24/Chrome断点调试/" rel="prev" title="Chrome断点调试">
            Chrome断点调试
          </a>
          <span>〉</span>
        
      </div>
    </div>
  
</div>


<script>
var link = document.getElementsByClassName('toc-link');
var hash = decodeURIComponent(location.hash);
if (hash){
} else {
  link[0].classList.add('toc-link-active');
}

var h3 = document.getElementsByTagName('h3');
var h4 = document.getElementsByTagName('h4');
var h5 = document.getElementsByTagName('h5');
var link_arr = [];
function addToArr(arr){
  for(var i = 0; i < arr.length; i++){
    link_arr.push(arr[i].offsetTop);
  }
}
addToArr(h3);
addToArr(h4);
addToArr(h5);


var compare = function (x, y) {
    if (x < y) {
        return -1;
    } else if (x > y) {
        return 1;
    } else {
        return 0;
    }
}

link_arr.sort(compare);


window.onscroll = function(){
  var height = document.documentElement.scrollTop;
  for (var i = 0; i < link_arr.length; i++){
    if (link_arr[i] > height){
      for(var j = 0; j < link.length; j++){
        link[j].classList.remove('toc-link-active');
      }
      document.getElementsByClassName('toc-link')[i].classList.add('toc-link-active');
      break;
    } 
  }
}

</script>
    </div>
  </div>
  




    <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js"></script>
    
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // listen to any DOM change and automatically perform spacing via MutationObserver()
        pangu.autoSpacingPage();
      });

      window.addEventListener("load", event => {
        // 判断浏览器是否支持
        if ("serviceWorker" in navigator) {
          window.navigator.serviceWorker
            .register("/sw.js", {
              scope: "/"
            })
        }
      });
    </script>
</body>
</html>

